(function () {
'use strict';
let p={API_CALL:"api_call",BACK_ICON:"back_icon",CLOSE_ICON:"close_icon",INSTANT_START:"instant_start",PIP_NATIVE_ICON:"pip_native_icon",SCROLL:"scroll",TOGGLE_ICON:"toggle_icon"},r=16/9,d=[],c=e=>(d=[...d,e],()=>{d=d.filter(t=>t!==e)}),P=()=>{d.forEach(e=>e()),d=[]},u=[],g=(e,t,i,o)=>{let n=e.on(t,i,o);u=[...u,n];let l=()=>{n(),u=u.filter(e=>e!==n)};return c(l),l},m=e=>e._do_not_use_a933c3bfa4cdfcdec4db.rootNode,y=e=>{var t;return null===(t=m(e))||void 0===t?void 0:t.querySelector(".dailymotion-player-wrapper")},_=e=>{var t;return null===(t=m(e))||void 0===t?void 0:t.querySelector(".dailymotion-player")},h={state:{},prevState:{},defaultState:{isRunning:!1,displayMode:null,isSmallViewportDisplay:!1,isExpanded:!1,isPipCustomPosition:!1,hasPipBanner:!1,hasRequestedPipNative:!1,uiActionOrigin:null,playerSelectedForPip:null,playerSelectedForPipNative:null,pipPositionX:null,pipPositionY:null,pipTransformSmallViewportCollapsed:null},nonPersistentStateProps:["uiActionOrigin"],onStateChange(){},setState(e){this.nonPersistentStateProps.forEach(t=>{Object.prototype.hasOwnProperty.call(e,t)||(e={...e,[t]:this.defaultState[t]})}),this.prevState={...this.prevState,...this.state},this.state={...this.state,...e},this.onStateChange(this.prevState,this.state)}},f=e=>{h.setState(e)},S=()=>h.state,b=()=>h.defaultState,E=e=>{h.onStateChange=e},C=null,I=!1,N=!1,w=null,A=Object.values(window.dailymotion._do_not_use_a933c3bfa4cdfcdec4db.players);for(let e=0;e<A.length;e++)if("off"!==A[e]._do_not_use_a933c3bfa4cdfcdec4db.settings.pip){I=A[e]._do_not_use_a933c3bfa4cdfcdec4db.settings.enableStartPipExpanded;break}let R=()=>window.innerWidth<=_dmpesplayer.B.SMALL?"small":"large",x=()=>"small"===R(),L=e=>!!x()&&(!!$()||!!N||null!=e&&!!e.adIsPlaying),O=(t,o)=>{let n=e=>{e&&f({isExpanded:L(),displayMode:R(),isSmallViewportDisplay:x()}),T(t)};F(t,o),g(t,_dmpesplayer.b.PUBLIC.VIDEO_PLAY,()=>{f({hasPipBanner:t.getSettings().enableGooglePolicyUi&&t.getSettings().enablePlaybackControls})}),n();let l=_dmpesplayer.a(window,"resize",n);c(()=>{l(),B(t),document.body.offsetWidth,w&&(w(),w=null)})},v=(e,t,i)=>{S().isRunning&&!N&&(C=!!t,f({hasPipBanner:e.getSettings().enableGooglePolicyUi&&e.getSettings().enablePlaybackControls,isExpanded:C,uiActionOrigin:i}),T(e,{animate:!1}))},T=function(t){let{animate:i=!1,computePlayerIframeSizes:o=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};B(t,{animate:i,computePlayerIframeSizes:o});let n=m(t),l=y(t),a=_(t),s=$()||N,p=S().hasPipBanner,{dynamicWidth:d,dynamicHeight:c}=D(),P=document.documentElement.clientWidth,u=Math.round(P/r)+(p?32:0);l.id=`dailymotion-pip-${R()}-viewport`;let{defaultPositionX:g,defaultPositionY:h,defaultMargin:b}={large:{defaultPositionX:"right",defaultPositionY:"bottom",defaultMargin:"20px"},small:{defaultPositionX:"left",defaultPositionY:"top",defaultMargin:"0px"}}[R()],E=e=>getComputedStyle(document.querySelector(`#${l.id}`)).getPropertyValue(e),C=e=>""!==E(`--position-${e}`).trim();C("top")||C("bottom")||l.style.setProperty(`--position-${h}`,b),C("left")||C("right")||l.style.setProperty(`--position-${g}`,b),!C("bottom")&&w&&(w(),w=null),C("bottom")&&x()&&!w&&(w=_dmpesplayer.a(window,"scroll",()=>{T(t,{computePlayerIframeSizes:!1})}));let I=x()&&(C("bottom")||C("right")||E("--position-top")!==b||E("--position-left")!==b),A=C("left")||C("top")||E("--position-bottom")!==b||E("--position-right")!==b,L=C("left")?"left":"right",O=C("top")?"top":"bottom",v=getComputedStyle(l),F=()=>"0.00001"!==parseFloat(v.marginRight).toPrecision(1)?`${parseFloat(v.marginRight)}px`:"left"!==L||isNaN(E("--position-left").trim())?"right"!==L||isNaN(E("--position-right").trim())?`var(--position-${L})`:`${Number(E("--position-right"))}px`:`${Number(E("--position-left"))}px`,V=()=>"0.00001"!==parseFloat(v.marginBottom).toPrecision(1)?`${parseFloat(v.marginBottom)}px`:"top"!==O||isNaN(E("--position-top").trim())?"bottom"!==O||isNaN(E("--position-bottom").trim())?`var(--position-${O})`:`${Number(E("--position-bottom"))}px`:`${Number(E("--position-top"))}px`,M=()=>"large"===R()?p?c+32:c:s?u:p?136:104,G=()=>"large"===R()?d:P;Object.assign(l.style,{boxShadow:"0 0.25rem 0.5rem rgba(0, 0, 0, 0.2)",height:`${M()}px`,position:"fixed",transform:(()=>{let e,t;let i=[],o=l.parentNode;for(;o!==document&&o;)i.push(o),o=o.parentNode;let a=document.documentElement.scrollLeft?document.documentElement.scrollLeft:i.reduce((e,t)=>{let{scrollLeft:i}=t;return e+i},0),s=document.documentElement.scrollTop?document.documentElement.scrollTop:i.reduce((e,t)=>{let{scrollTop:i}=t;return e+i},0);return"rtl"===v.direction?("right"===L&&(e=document.documentElement.clientWidth),"left"===L&&(e=G()),e-=n.getBoundingClientRect().right):("right"===L&&(e=document.documentElement.clientWidth-G()),"left"===L&&(e=0),e-=n.getBoundingClientRect().left),e-=a,"bottom"===O&&(t=window.innerHeight-M()),"top"===O&&(t=0),t=t-n.getBoundingClientRect().top-s,`translate(
      calc(${e}px ${"right"===L?"-":"+"} ${F()}),
      calc(${t}px ${"bottom"===O?"-":"+"} ${V()})
    )`})(),transition:"none",width:`${G()}px`,zIndex:0x7fffffff,bottom:"unset",left:"unset",right:"unset",top:"unset",borderRadius:`${"large"===R()?"0.5rem":"0rem"}`});let U=null;x()&&(Object.assign(a,{height:`${u}px`,width:`${P}px`}),U=Math.round((u-104)/2),Object.assign(a.style,{height:`${u}px`,transition:"none",transform:s?"translate(0px,0px)":`translate(0px, -${U}px)`,width:`${P}px`})),f({isPipCustomPosition:I||A,pipPositionX:l.getBoundingClientRect().x,pipPositionY:l.getBoundingClientRect().y,uiActionOrigin:S().uiActionOrigin,pipTransformSmallViewportCollapsed:U})},$=()=>!!C||null===C&&!!I,B=function(e){let{animate:t=!1,computePlayerIframeSizes:i=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=y(e),n=_(e);o.removeAttribute("id"),o.style.removeProperty("--position-top"),o.style.removeProperty("--position-left"),o.style.removeProperty("--position-bottom"),o.style.removeProperty("--position-right"),Object.assign(o.style,{boxShadow:"unset",...t?{}:{height:"100%"},position:"absolute",transform:"translate(0px,0px)",width:"100%",zIndex:"auto",margin:"0.00001px",borderRadius:"0px"}),i&&(Object.assign(n,{height:"100%",width:"100%"}),Object.assign(n.style,{height:"100%",transform:"translate(0px,0px)",transition:"none",width:"100%"}))},D=()=>{let e=window.innerWidth;if(e<=_dmpesplayer.B.MEDIUM)return{dynamicWidth:410,dynamicHeight:Math.round(410/r)};if(e>=_dmpesplayer.B.LARGE)return{dynamicWidth:560,dynamicHeight:Math.round(560/r)};let i=_dmpesplayer.B.LARGE-_dmpesplayer.B.MEDIUM,o=Math.round((e-_dmpesplayer.B.LARGE+i)/i*150)+410,n=Math.round(o/r);return{dynamicWidth:o,dynamicHeight:n}},F=(e,t)=>{(N=t.adIsPlaying)?M(e):V(e)},V=e=>{g(e,_dmpesplayer.b.PUBLIC.AD_START,()=>{N=!0,f({hasPipBanner:e.getSettings().enableGooglePolicyUi&&e.getSettings().enableAdsControls}),$()||f({isExpanded:x()}),T(e),M(e)},{once:!0})},M=e=>{g(e,_dmpesplayer.b.PUBLIC.AD_END,()=>{N=!1,f({hasPipBanner:e.getSettings().enableGooglePolicyUi&&e.getSettings().enablePlaybackControls}),$()||f({isExpanded:!1}),T(e),V(e)},{once:!0})},G=(e,t,n)=>{let{isRunning:l,isExpanded:a}=t,{displayMode:s,isRunning:r,isExpanded:d,uiActionOrigin:c,playerSelectedForPipNative:P}=n,u={playerPipDisplay:`${s}Viewport`,playerPipIsExpanded:d,playerPipStatus:c===p.CLOSE_ICON?"closed":"enabled",playerPresentationMode:r?"pip":P?"nativePip":"inline"},{id:g,stateFromPES:m}=e._do_not_use_a933c3bfa4cdfcdec4db;Object.assign(m,u),l!==r&&_dmpesplayer.s(_dmpesplayer.b.PUBLIC.PLAYER_PRESENTATIONMODECHANGE,{id:g,...u}),a!==d&&_dmpesplayer.s(_dmpesplayer.b.PUBLIC.PLAYER_PIPEXPANDEDCHANGE,{id:g,...u})},U=(e,t,i)=>{let{isRunning:o,isSmallViewportDisplay:s,isExpanded:p,isPipCustomPosition:r,hasPipBanner:d,hasRequestedPipNative:c,pipPositionX:P,pipPositionY:u,pipTransformSmallViewportCollapsed:g}=t,{isRunning:m,isSmallViewportDisplay:y,isExpanded:_,isPipCustomPosition:h,hasPipBanner:f,hasRequestedPipNative:S,uiActionOrigin:b,pipPositionX:E,pipPositionY:C,pipTransformSmallViewportCollapsed:I}=i;if(o!==m||s!==y||p!==_||d!==f||r!==h||c!==S||P!==E||u!==C||g!==I){let t={isRunning:m,isSmallViewportDisplay:y,isExpanded:_,isPipCustomPosition:h,hasPipBanner:f,hasRequestedPipNative:S,uiActionOrigin:b,screenId:window.dailymotion._do_not_use_a933c3bfa4cdfcdec4db.screenId,pipPositionX:E,pipPositionY:C,pipTransformSmallViewportCollapsed:I};_dmpesplayer.l.log("pip","Sending new PIP state to player :",t),_dmpesplayer.c(e,_dmpesplayer.C.NOTIFY_PIP_CHANGED,t)}},Y=()=>{},j=()=>{},X=e=>{v(S().playerSelectedForPip,!0,e)},q=e=>{v(S().playerSelectedForPip,!1,e)},W=()=>{T(S().playerSelectedForPip)},H=()=>{f({...b()}),Y=i=>{e(),t(),o(),l(),a(),r(),j(i)};let e=_dmpesplayer.d(_dmpesplayer.b.PUBLIC.PLAYER_VIEWABILITYCHANGE,e=>{let{viewable:t,wasViewableAtLeastOnce:i,id:o,uiActionOrigin:l}=e,a=window.dailymotion._do_not_use_a933c3bfa4cdfcdec4db.players[o];if(!a||"off"===a._do_not_use_a933c3bfa4cdfcdec4db.settings.pip||S().playerSelectedForPip&&a!==S().playerSelectedForPip||S().playerSelectedForPipNative)return;let{status:s,reason:r}=a.isEligibleForPipDisplay(i);_dmpesplayer.l.log("pip",`Viewability change received
        - is player viewable : ${t}
        - is player eligible for PIP display : ${s} (${r})`),t?j(l||p.SCROLL):!t&&a.isEligibleForPipDisplay(i).status&&a.getState().then(e=>{k(a,e,i||"instant"!==a._do_not_use_a933c3bfa4cdfcdec4db.settings.pip?p.SCROLL:p.INSTANT_START)})}),t=_dmpesplayer.d(_dmpesplayer.b.PUBLIC.PLAYER_PRESENTATION_MODE_CHANGE,e=>{let{playerPresentationMode:t,id:i}=e,o=window.dailymotion._do_not_use_a933c3bfa4cdfcdec4db.players[i];if(o){if("inline"===t&&S().playerSelectedForPipNative===o&&f({playerSelectedForPipNative:null}),"nativePip"===t){f({playerSelectedForPipNative:o}),S().hasRequestedPipNative&&f({hasRequestedPipNative:!1}),S().playerSelectedForPip&&j(p.PIP_NATIVE_ICON);return}o.getState().then(e=>{e.playerIsViewable||k(o,e,p.PIP_NATIVE_ICON)})}}),o=_dmpesplayer.d(_dmpesplayer.b.PRIVATE.CLOSE_PIP_REQUESTED,()=>{Y(p.CLOSE_ICON)}),l=_dmpesplayer.d(_dmpesplayer.b.PRIVATE.BACK_TO_INLINE_DISPLAY_REQUESTED,()=>{let e=S().playerSelectedForPip,{observer:t}=e._do_not_use_a933c3bfa4cdfcdec4db;t.setUIActionOrigin(p.BACK_ICON),m(e).scrollIntoView({block:"start"})}),a=_dmpesplayer.d(_dmpesplayer.b.PRIVATE.COLLAPSE_PIP_REQUESTED,()=>{v(S().playerSelectedForPip,!1,p.TOGGLE_ICON)}),r=_dmpesplayer.d(_dmpesplayer.b.PRIVATE.EXPAND_PIP_REQUESTED,()=>{v(S().playerSelectedForPip,!0,p.TOGGLE_ICON)})},k=(e,t,i)=>{if(S().isRunning||window.dailymotion._do_not_use_a933c3bfa4cdfcdec4db.playerSelectedForPip!==e||S().playerSelectedForPipNative)return;j=t=>{S().isRunning&&(P(),f({isPipCustomPosition:!1,isRunning:!1,hasPipBanner:!1,pipPositionX:null,pipPositionY:null,playerSelectedForPip:null,uiActionOrigin:t}),E(()=>{}),(t===p.CLOSE_ICON||t===p.API_CALL)&&e.pause())},E((t,i)=>{G(e,t,i),U(e,t,i)});let o=e.getSettings().enableGooglePolicyUi,n=!t.adIsPlaying&&e.getSettings().enablePlaybackControls,l=t.adIsPlaying&&e.getSettings().enableAdsControls;f({hasPipBanner:o&&(n||l),isRunning:!0,uiActionOrigin:i,displayMode:R(),isSmallViewportDisplay:x(),isExpanded:L(t),playerSelectedForPip:e}),O(e,t)};window.dailymotion.pipResume=()=>{_dmpesplayer.l.log("api","Called dailymotion.pipResume()"),H()},window.dailymotion.pipClose=()=>{_dmpesplayer.l.log("api","Called dailymotion.pipClose()"),Y(p.API_CALL)},window.dailymotion.pipExpand=()=>{_dmpesplayer.l.log("api","Called dailymotion.pipExpand()"),X(p.API_CALL)},window.dailymotion.pipCollapse=()=>{_dmpesplayer.l.log("api","Called dailymotion.pipCollapse()"),q(p.API_CALL)},window.dailymotion.pipRepaint=()=>{_dmpesplayer.l.log("api","Called dailymotion.pipRepaint()"),W()};
})();
